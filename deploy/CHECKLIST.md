# Dimensio 部署检查清单

在部署到生产环境前，请确保完成以下检查项。

## 📋 部署前检查

### 服务器准备
- [ ] 服务器满足最低配置要求（2核CPU，4GB内存，20GB磁盘）
- [ ] 操作系统版本符合要求（Ubuntu 20.04+ 或 Debian 10+）
- [ ] 具有 root 或 sudo 权限
- [ ] 已配置 SSH 访问
- [ ] 防火墙规则已配置（开放 22, 80, 443 端口）

### 软件依赖
- [ ] Python 3.7+ 已安装
- [ ] Node.js 14+ 和 npm 已安装
- [ ] Nginx 已安装
- [ ] Git 已安装
- [ ] 网络连接正常（可以访问外部仓库）

### 域名和证书
- [ ] 已准备域名（或使用 IP 地址）
- [ ] DNS 记录已正确配置（A 记录指向服务器 IP）
- [ ] SSL 证书已准备（如果使用 HTTPS）
- [ ] 证书有效期检查（Let's Encrypt 或其他）

### 配置文件
- [ ] 已复制 `.env.example` 为 `.env`
- [ ] 已修改 `SERVER_NAME` 为实际域名或IP
- [ ] 已设置合适的 `DEPLOY_PATH`
- [ ] 已配置 `API_WORKERS` 数量
- [ ] 已设置 `SERVICE_USER` 和 `SERVICE_GROUP`

## 🚀 部署过程检查

### 安装阶段
- [ ] 系统依赖检查通过
- [ ] 项目文件已成功复制到 `/var/www/dimensio`
- [ ] Python 虚拟环境创建成功
- [ ] Python 依赖安装完成（无错误）
- [ ] 前端依赖安装完成（npm install）
- [ ] 前端构建成功（npm run build）
- [ ] 目录权限设置正确

### 服务配置
- [ ] Nginx 配置文件已复制并修改
- [ ] Nginx 配置测试通过（nginx -t）
- [ ] Systemd 服务文件已配置
- [ ] 服务文件语法正确
- [ ] systemd daemon 已重新加载

### 服务启动
- [ ] dimensio-api 服务启动成功
- [ ] Nginx 服务启动成功
- [ ] 服务已设置为开机自启动
- [ ] 端口 5000 监听正常（API）
- [ ] 端口 80 监听正常（Nginx）

## ✅ 功能测试

### 基础功能
- [ ] 根路径访问正常（http://your-domain.com）
- [ ] 前端页面加载正常
- [ ] 静态资源加载正常（JS、CSS、图片）
- [ ] API 根路径访问正常（/api/）
- [ ] 健康检查端点正常（/health）

### API 功能
- [ ] 文件上传功能正常
- [ ] 配置文件验证正常
- [ ] 压缩任务执行成功
- [ ] 压缩结果返回正常
- [ ] 历史记录查询正常

### 错误处理
- [ ] 404 页面正常显示
- [ ] 500 错误处理正常
- [ ] 文件上传失败有正确的错误提示
- [ ] 超时处理正常

### 性能测试
- [ ] 页面加载速度可接受（< 3秒）
- [ ] API 响应速度正常（< 1秒）
- [ ] 文件上传速度正常
- [ ] 压缩任务不会超时
- [ ] 并发请求处理正常

## 🔒 安全检查

### 系统安全
- [ ] 已更新系统到最新版本
- [ ] 已禁用 root SSH 登录（可选）
- [ ] 已配置 SSH 密钥认证
- [ ] 防火墙规则已启用并正确配置
- [ ] 已关闭不必要的服务和端口

### 应用安全
- [ ] 已设置正确的文件权限
- [ ] 敏感目录不可直接访问
- [ ] 已配置文件上传大小限制
- [ ] 已配置请求速率限制（可选）
- [ ] 已启用 HTTPS（生产环境必须）

### 数据安全
- [ ] 数据目录权限正确设置
- [ ] 日志目录权限正确设置
- [ ] 备份策略已制定
- [ ] 定期备份已配置（cron job）

## 📊 监控和日志

### 日志配置
- [ ] API 访问日志记录正常
- [ ] API 错误日志记录正常
- [ ] Nginx 访问日志记录正常
- [ ] Nginx 错误日志记录正常
- [ ] Systemd 日志可正常查看
- [ ] 日志轮转已配置

### 监控配置
- [ ] 服务状态监控已配置
- [ ] 磁盘空间监控已配置
- [ ] CPU 和内存使用监控已配置
- [ ] 告警机制已配置（可选）

## 📚 文档和维护

### 文档完整性
- [ ] 部署文档已保存
- [ ] 配置文件已备份
- [ ] 管理员联系方式已记录
- [ ] 服务器访问信息已安全保存

### 备份和恢复
- [ ] 首次备份已创建
- [ ] 备份恢复流程已测试
- [ ] 备份保留策略已制定
- [ ] 自动备份脚本已配置

### 更新和维护
- [ ] 更新流程已文档化
- [ ] 回滚流程已测试
- [ ] 维护窗口已规划
- [ ] 紧急联系人已指定

## 🎯 生产环境专属

### 高可用性（可选）
- [ ] 已配置负载均衡
- [ ] 已配置数据库主从复制
- [ ] 已配置服务自动重启
- [ ] 已配置故障转移机制

### 性能优化
- [ ] 已启用 Gzip 压缩
- [ ] 已配置静态资源缓存
- [ ] 已优化数据库查询
- [ ] 已配置 CDN（可选）

### 合规性
- [ ] 已遵守数据保护法规
- [ ] 已配置访问日志审计
- [ ] 已实施隐私政策
- [ ] 已配置数据加密（传输和存储）

## 📝 部署完成确认

部署完成后，填写以下信息：

```
部署日期: _______________
部署人员: _______________
服务器地址: _______________
域名: _______________
版本号: _______________
备注: _______________
```

## ⚠️ 问题记录

如果遇到问题，请在此记录：

```
问题描述:
__________________________
__________________________

解决方案:
__________________________
__________________________

处理时间:
__________________________
```

---

**所有检查项完成后，部署才算真正成功！** ✅

如有问题，请参考：
- [详细部署文档](./README.md)
- [快速部署指南](./QUICKSTART.md)
- [Docker 部署方式](./docker/README.md)
